(function(e){"use strict";var s=function(t,n){var a,r,c,d,u,m,f,p,g,i=e(t),o=e.extend(g,n),l=[],h=0,s=this;this.setup=function(){var t,n,i=new CHBSHelper;if(i.getMessageFromConsole(),s.e('select,input[type="hidden"]').each(function(){e(this)[0].hasAttribute("data-value")&&e(this).val(e(this).attr("data-value"))}),parseInt(o.google_map_option.ask_load_enable,10)===1&&isNaN(parseInt(s.e('[name="chbs_google_maps_enable"]').val(),10))){n=window.location.href,n.indexOf("?")===-1?n+="?":n+="&",confirm(o.message.google_map_ask_load_confirm)?window.location.href=n+"chbs_google_maps_enable=1":window.location.href=n+"chbs_google_maps_enable=-1";return}if(s.init(),parseInt(o.icon_field_enable,10)===1){for(t=1;t<=3;t++)s.e('input[name="chbs_pickup_date_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-date-1"></span>'),s.e('input[name="chbs_pickup_time_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-time-1"></span>'),s.e('input[name="chbs_return_date_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-date-1"></span>'),s.e('input[name="chbs_return_time_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-time-1"></span>');for(t=1;t<=2;t++)s.e('input[name="chbs_pickup_location_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-location-1"></span>'),s.e('input[name="chbs_dropoff_location_service_type_'+t+'"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-location-1"></span>');s.e('input[name="chbs_passenger_adult_service_type_1"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-passengers-1"></span>'),s.e('input[name="chbs_passenger_adult_service_type_3"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-passengers-1"></span>'),s.e('input[name="chbs_passenger_children_service_type_1"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-passengers-1"></span>'),s.e('input[name="chbs_passenger_children_service_type_3"]').before('<span class="chbs-meta-icon-2 chbs-meta-icon-2-passengers-1"></span>')}},this.init=function(){var n,r,l,d,t=new CHBSHelper;t.isMobile()&&(s.e('input[name="chbs_pickup_date_service_type_1"]').prop("readonly",!0),s.e('input[name="chbs_pickup_date_service_type_2"]').prop("readonly",!0),s.e('input[name="chbs_pickup_date_service_type_3"]').prop("readonly",!0),s.e('input[name="chbs_return_date_service_type_1"]').prop("readonly",!0),s.e('input[name="chbs_return_date_service_type_3"]').prop("readonly",!0)),s.createButtonRadio(".chbs-booking-extra"),e(window).resize(function(){try{s.e("select").selectmenu("close")}catch{}try{s.e(".chbs-datepicker").datepicker("hide")}catch{}try{s.e(".chbs-timepicker").timepicker("hide")}catch{}try{s.e(".ui-timepicker-wrapper").css({opacity:0})}catch{}try{var e=a.getCenter();google.maps.event.trigger(a,"resize"),a.setCenter(e)}catch{}}),s.setWidthClass(),parseInt(o.use_my_location_link_enable,10)===1&&navigator.geolocation&&(s.e(".chbs-my-location-link").css("display","inline"),navigator.geolocation.getCurrentPosition(s.myLocationSuccess,s.myLocationError)),n=1,r=s.e(".chbs-tab>ul").children('li[data-id="'+parseInt(s.e('[name="chbs_service_type_id"]').val())+'"]',10),r.length===1&&(n=r.index()),s.e(".chbs-tab").tabs({activate:function(){e(".qtip").remove(),s.googleMapReInit();var o=s.getServiceTypeId();s.setServiceTypeId(o),s.showRideInfo(),s.googleMapCreate(),s.googleMapCreateRoute()},active:n}),s.e(".chbs-main-navigation-default a").on("click",function(t){t.preventDefault();var n=parseInt(e(this).parent("li").data("step"),10),o=parseInt(s.e('input[name="chbs_step"]').val(),10);if(n-o===0)return;s.goToStep(n-o)}),s.e(".chbs-button-step-next").on("click",function(e){e.preventDefault(),s.goToStep(1)}),s.e(".chbs-button-step-prev").on("click",function(e){e.preventDefault(),s.goToStep(-1)}),s.e(".chbs-main-content").on("click",".chbs-form-field",function(t){if(e(this).find(':input[type="file"]').length)return;if(e(".qtip").remove(),t.preventDefault(),e(t.target).hasClass("chbs-location-add")||e(t.target).hasClass("chbs-location-remove"))return;e(this).find(":input").focus();var n=e(this).find("select:not(.chbs-selectmenu-disable)");n.length&&n.selectmenu("open")}),s.e(".chbs-location-add").on("click",function(t){t.preventDefault();var n,i,a,o=e(this).parent(".chbs-form-field:first"),r=o.next(".chbs-form-field-waypoint-duration");parseInt(r.length,10)===1&&(o=r),n=s.e(".chbs-form-field-location-autocomplete.chbs-hidden").clone(!0,!0),n.insertAfter(o),n.removeClass("chbs-hidden"),n.find(":input").focus(),i=s.e(".chbs-form-field-waypoint-duration.chbs-hidden"),parseInt(i.length,10)===1&&(a=i.clone(!0,!0),a.insertAfter(n),a.removeClass("chbs-hidden"),s.createSelectMenu(!1)),s.googleMapAutocompleteCreate(n.find('input[type="text"]')),s.reCalculateRoute(),s.createLabelTooltip()}),s.e(".chbs-location-remove").on("click",function(t){t.preventDefault();var n=e(this).parent(".chbs-form-field:first"),o=n.next(".chbs-form-field-waypoint-duration");o.find("select").selectmenu("destroy"),n.remove(),o.remove(),s.googleMapCreate(),s.googleMapCreateRoute()}),s.e('.chbs-form-field-location-autocomplete input[type="text"]').each(function(){s.googleMapAutocompleteCreate(e(this))}),s.e(".chbs-payment-form").on("click",".chbs-payment>li>a",function(t){t.preventDefault(),e(this).parents(".chbs-payment").find("li>a").removeClass("chbs-state-selected"),e(this).addClass("chbs-state-selected"),s.getGlobalNotice().addClass("chbs-hidden"),s.e('input[name="chbs_payment_id"]').val(e(this).attr("data-payment-id")),s.createSummaryPriceElement()}),s.e(">*").on("click",".chbs-form-checkbox",function(){var n=e(this).next('input[type="hidden"]'),s=parseInt(n.val(),10)===1?0:1;s===1?e(this).addClass("chbs-state-selected"):e(this).removeClass("chbs-state-selected"),e(this).next('input[type="hidden"]').on("change",function(){var s=parseInt(e(this).val(),10)===1?1:0,n=e(this).parents(".chbs-clear-fix:first").nextAll(".chbs-panel:first");s===0?n.addClass("chbs-hidden"):n.removeClass("chbs-hidden"),e(window).scroll()}),n.val(s).trigger("change")}),s.e(".chbs-booking-extra").on("click",".chbs-booking-extra-list .chbs-button.chbs-button-style-2",function(t){t.preventDefault();var o,n=e(this).parents("li:first").find(".chbs-booking-form-extra-note");e(this).parent(".chbs-button-radio").length?parseInt(e(this).attr("data-value"),10)!==0?n.removeClass("chbs-hidden"):n.addClass("chbs-hidden"):(e(this).toggleClass("chbs-state-selected"),e(this).hasClass("chbs-state-selected")?n.removeClass("chbs-hidden"):n.addClass("chbs-hidden")),o=[],s.e(".chbs-booking-extra-list .chbs-button.chbs-button-style-2").each(function(){e(this).hasClass("chbs-state-selected")&&o.push(e(this).attr("data-value"))}),s.e('input[name="chbs_booking_extra_id"]').val(o.join(",")),s.createSummaryPriceElement()}),s.e(".chbs-booking-extra").on("blur",'.chbs-booking-extra-list input[type="text"]',function(){isNaN(e(this).val())&&e(this).val(1),s.createSummaryPriceElement()}),s.e(".chbs-booking-extra").on("click",".chbs-booking-extra-list .chbs-column-2",function(){e(this).find('input[type="text"]').select()}),s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle-list .chbs-button.chbs-button-style-2:not(.chbs-button-on-request)",function(t){if(t.preventDefault(),e(this).hasClass("chbs-state-selected"))return;s.e(".chbs-vehicle-list .chbs-button.chbs-button-style-2").removeClass("chbs-state-selected"),e(this).addClass("chbs-state-selected"),s.e('input[name="chbs_vehicle_id"]').val(parseInt(e(this).parents(".chbs-vehicle").attr("data-id"),10)),s.e(".chbs-vehicle-content-price-bid>div").addClass("chbs-hidden"),s.e('.chbs-vehicle-list [name="chbs_vehicle_bid_price[]"]').val(""),e(this).parents(".chbs-vehicle").find(".chbs-vehicle-content-price-bid>div:first-child").removeClass("chbs-hidden"),s.getGlobalNotice().addClass("chbs-hidden"),s.calculateBaseLocationDistance(function(){if(s.createSummaryPriceElement(),parseInt(o.scroll_to_booking_extra_after_select_vehicle_enable,10)===1){var t=s.e(".chbs-booking-extra-header");t.length===1&&e.scrollTo(t,200,{offset:-50})}s.manageBookingExtra()})}),s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle .chbs-vehicle-content .chbs-show-more-button a",function(t){t.preventDefault(),e(this).toggleClass("chbs-state-selected");var n=e(this).parents(".chbs-vehicle:first").find(".chbs-vehicle-content-description"),s=parseInt(n.children("div").actual("outerHeight",{includeMargin:!0}),10);n.hasClass("chbs-state-open")?n.animate({height:0},150,function(){n.removeClass("chbs-state-open"),e(window).scroll()}):n.animate({height:s},150,function(){n.css("height","auto"),n.addClass("chbs-state-open"),e(window).scroll()})}),s.e(".chbs-main-content-step-2").on("click",".chbs-booking-extra .chbs-booking-extra-header .chbs-show-more-button a",function(t){t.preventDefault(),e(this).toggleClass("chbs-state-selected");var n=e(this).parents(".chbs-booking-extra:first").children(".chbs-booking-extra-header+div"),s=parseInt(n.children("div").actual("outerHeight",{includeMargin:!0}),10);n.hasClass("chbs-state-open")?n.animate({height:0},150,function(){n.removeClass("chbs-state-open"),e(window).scroll()}):n.animate({height:s},150,function(){n.css("height","auto"),n.addClass("chbs-state-open"),e(window).scroll()})}),s.e(".chbs-main-content-step-4").on("click",".chbs-summary .chbs-summary-header a",function(t){t.preventDefault(),s.goToStep(parseInt(e(this).attr("data-step"),10)-4)}),s.e(".chbs-main-content-step-4").on("click",".chbs-coupon-code-section a",function(t){t.preventDefault(),s.setAction("coupon_code_check"),s.post(s.e('form[name="chbs-form"]').serialize(),function(t){s.e(".chbs-summary-price-element").replaceWith(t.html);var n=s.e(".chbs-coupon-code-section");n.qtip({show:{target:e(this)},style:{classes:t.error===1?"chbs-qtip chbs-qtip-error":"chbs-qtip chbs-qtip-success"},content:{text:t.message},position:{my:o.is_rtl?"bottom right":"bottom left",at:o.is_rtl?"top right":"top left",container:n.parent()}}).qtip("show")})}),s.e(".chbs-main-content-step-4").on("click",".chbs-gratuity-section a",function(t){t.preventDefault(),s.setAction("gratuity_customer_set"),s.post(s.e('form[name="chbs-form"]').serialize(),function(t){s.e(".chbs-summary-price-element").replaceWith(t.html);var n=s.e(".chbs-gratuity-section");n.qtip({show:{target:e(this)},style:{classes:t.error===1?"chbs-qtip chbs-qtip-error":"chbs-qtip chbs-qtip-success"},content:{text:t.message},position:{my:o.is_rtl?"bottom right":"bottom left",at:o.is_rtl?"top right":"top left",container:n.parent()}}).qtip("show"),n.find('[name="chbs_gratuity_customer_value"]').val(t.gratuity)})}),s.e(".chbs-datepicker:not(.chbs-datepicker-form-element)").datepicker({autoSize:!0,minDate:o.datetime_min_format,maxDate:o.datetime_max_format,dateFormat:o.date_format_js,beforeShow:function(t,n){var i,r,c=new CHBSHelper,a=c.getValueFromClass(e(n.dpDiv),"chbs-booking-form-id-");if(a!==!1&&e(n.dpDiv).removeClass("chbs-booking-form-id-"+a),e(n.dpDiv).addClass("chbs-booking-form-id-"+o.booking_form_id).addClass("chbs-datepicker"),e(t).attr("name")==="chbs_return_date_service_type_"+s.getServiceTypeId())try{i=s.e('[name="chbs_pickup_date_service_type_'+s.getServiceTypeId()+'"]').val(),r=e.datepicker.parseDate(o.date_format_js,i),r!==null&&e(this).datepicker("option","minDate",i)}catch{}},beforeShowDay:function(t){var t,s,i,a,r=new CHBSHelper,n=parseInt(t.getDay(),10);n===0&&(n=7),t=e.datepicker.formatDate("dd-mm-yy",t);for(i in o.date_exclude)if(a=r.compareDate([t,o.date_exclude[i].start,o.date_exclude[i].stop]),a)return[!1,"",""];return s=t.split("-"),t=new Date(s[2],s[1]-1,s[0]),!o.business_hour[n].start||!o.business_hour[n].stop?[!1,"",""]:[!0,"",""]},onSelect:function(t,n){var a,c,l,d,u,h,m,p,g,v,f=new CHBSHelper,r=[n.selectedDay,n.selectedMonth+1,n.selectedYear];for(p in r)new String(r[p]).length===1&&(r[p]="0"+r[p]);if(r=r[0]+"-"+r[1]+"-"+r[2],a=parseInt(e(this).datepicker("getDate").getDay(),10),a===0&&(a=7),g=e(this).attr("name").indexOf("pickup")>-1?"pickup":"return",c=s.e('input[name="chbs_'+g+"_time_service_type_"+s.getServiceTypeId()+'"]'),parseInt(o.pickup_time_field_write_enable,10)===1||g==="return"){if(d="",u="",(f.isEmpty(d)||f.isEmpty(u))&&new String(typeof o.business_hour[a])!=="undefined"&&(d=o.business_hour[a].start,u=o.business_hour[a].stop),l=o.datetime_min.split(" "),r===l[0]&&Date.parse("01/01/1970 "+l[1])>Date.parse("01/01/1970 "+d)&&(d=l[1]),f.isEmpty(o.datetime_max)||(l=o.datetime_max.split(" "),r===l[0]&&Date.parse("01/01/1970 "+l[1])<Date.parse("01/01/1970 "+u)&&(u=l[1])),h={appendTo:i,showOn:[],showOnFocus:!1,timeFormat:o.time_format,step:o.timepicker_step,disableTouchKeyboard:!0,minTime:d,maxTime:u,disableTextInput:parseInt(o.timepicker_field_readonly,10)===1},parseInt(o.timepicker_dropdown_list_enable,10)===1){try{c.timepicker("remove")}catch{}if(parseInt(s.getServiceTypeId(),10)===3){v=s.e('select[name="chbs_route_service_type_3"]>option:selected');try{m=JSON.parse(v.attr("data-time_exclude")),m[a]!=void 0&&(h.step=1,h.disableTextInput=!0,h.disableTimeRanges=m[a],h.maxTime=m[a][m[a].length-2][1])}catch{}}c.timepicker(h),c.val("").timepicker("show"),c.blur(),s.setTimepicker(c),parseInt(o.timepicker_hour_range_enable,10)===1&&(e(".ui-timepicker-list>li").each(function(){var t=[e(this),e(this).next()];t[1].length===1?t[0].html(t[0].text()+" - "+t[1].text()):t[0].remove()}),c.on("selectTime",function(){var s=e(".ui-timepicker-list>.ui-timepicker-selected");s.length===1&&e(this).val(s.text())}))}}else new String(typeof o.business_hour[a])!=="undefined"&&c.val(o.business_hour[a].default)}}),e(".ui-datepicker").addClass("notranslate"),parseInt(o.timepicker_dropdown_list_enable,10)===1&&i.on("focusin",".chbs-timepicker:not(.chbs-timepicker-form-element)",function(){var t=new CHBSHelper,o=e(this).attr("name").indexOf("pickup")>-1?"pickup":"return",n=s.e('input[name="chbs_'+o+"_date_service_type_"+s.getServiceTypeId()+'"]');if(t.isEmpty(n.val())){e(this).timepicker("remove"),n.click();return}t.isEmpty(e(this).val())&&e(this).timepicker("show")}),s.createSelectMenu(),s.createFixedLocationAutocomplete(),s.e(".chbs-booking-extra").on("blur",'.chbs-booking-extra-list input[type="text"]',function(){if(!e(this)[0].hasAttribute("data-quantity-max"))return;var t=e(this).val();isNaN(t)&&(t=1),t=parseInt(t,10),t>parseInt(e(this).attr("data-quantity-max"),10)&&e(this).val(e(this).attr("data-quantity-max")),s.createSummaryPriceElement()}),s.e(".chbs-form-field").has("select").css({cursor:"pointer"}),s.e(".chbs-main-content-step-3").on("click",".chbs-button-sign-up",function(e){e.preventDefault(),s.e(".chbs-client-form-sign-up").removeClass("chbs-hidden"),s.e('input[name="chbs_client_account"]').val(1)}),s.e(".chbs-main-content").on("click",".chbs-button-widget-submit",function(t){t.preventDefault();var i,a,r,c,l,d,u,m,h=new CHBSHelper,n={};n.service_type_id=s.getServiceTypeId(),n.pickup_date=s.e('[name="chbs_pickup_date_service_type_'+n.service_type_id+'"]').val(),n.pickup_time=s.e('[name="chbs_pickup_time_service_type_'+n.service_type_id+'"]').val(),e.inArray(s.getServiceTypeId(),[1,2])>-1?(a=s.e('[name="chbs_pickup_location_coordinate_service_type_'+n.service_type_id+'"]').val(),h.isEmpty(a)||(i=JSON.parse(a),n.pickup_location_lat=i.lat,n.pickup_location_lng=i.lng,n.pickup_location_zip_code=i.zip_code,n.pickup_location_locality=i.locality,n.pickup_location_address=i.address,n.pickup_location_text=s.e('[name="chbs_pickup_location_service_type_'+n.service_type_id+'"]').val()),a=s.e('[name="chbs_dropoff_location_coordinate_service_type_'+n.service_type_id+'"]').val(),h.isEmpty(a)||(i=JSON.parse(a),n.dropoff_location_lat=i.lat,n.dropoff_location_lng=i.lng,n.dropoff_location_zip_code=i.zip_code,n.dropoff_location_locality=i.locality,n.dropoff_location_address=i.address,n.dropoff_location_text=s.e('[name="chbs_dropoff_location_service_type_'+n.service_type_id+'"]').val()),c=s.e('[name="chbs_fixed_location_pickup_service_type_'+n.service_type_id+'"]').val(),parseInt(c,10)>0&&(n.fixed_location_pickup_id=c),l=s.e('[name="chbs_fixed_location_dropoff_service_type_'+n.service_type_id+'"]').val(),parseInt(l,10)>0&&(n.fixed_location_dropoff_id=l)):n.route_id=s.e('[name="chbs_route_service_type_'+n.service_type_id+'"]').val(),e.inArray(s.getServiceTypeId(),[1,3])>-1&&(n.extra_time=s.e('[name="chbs_extra_time_service_type_'+n.service_type_id+'"]').val(),n.transfer_type=s.e('[name="chbs_transfer_type_service_type_'+n.service_type_id+'"]').val(),e.inArray(n.transfer_type,[3])&&(n.duration=s.e('[name="chbs_duration_service_type_'+n.service_type_id+'"]').val(),n.return_date=s.e('[name="chbs_return_date_service_type_'+n.service_type_id+'"]').val(),n.return_time=s.e('[name="chbs_return_time_service_type_'+n.service_type_id+'"]').val())),e.inArray(s.getServiceTypeId(),[2])>-1&&(n.duration=s.e('[name="chbs_duration_service_type_'+n.service_type_id+'"]').val()),d=s.e('[name="chbs_passenger_adult_service_type_'+n.service_type_id+'"]'),d.length===1&&(n.passenger_adult=d.val()),u=s.e('[name="chbs_passenger_children_service_type_'+n.service_type_id+'"]'),u.length===1&&(n.passenger_children=u.val()),n.currency=s.e('[name="chbs_currency"]').val(),n.widget_submit=1,n.widget_second_step=parseInt(s.e('[name="chbs_widget_second_step"]').val(),10),r=o.widget.booking_form_url,r.indexOf("?")===-1?r+="?":r+="&",r+=decodeURI(e.param(n)),m=s.e('form[name="chbs-form"]'),m.attr("action",r).submit()}),s.e(".chbs-main-content-step-3").on("click",".chbs-button-sign-in",function(e){e.preventDefault(),s.getGlobalNotice().addClass("chbs-hidden"),s.preloader(!0),s.setAction("user_sign_in"),s.post(s.e('form[name="chbs-form"]').serialize(),function(e){parseInt(e.user_sign_in,10)===1?(s.e(".chbs-main-content-step-3 .chbs-client-form").html(""),typeof e.client_form_sign_up!="undefined"&&s.e(".chbs-main-content-step-3 .chbs-client-form").append(e.client_form_sign_up),typeof e.summary!="undefined"&&s.e(".chbs-main-content-step-3>.chbs-layout-25x75 .chbs-layout-column-left:first").html(e.summary[0]),s.createSelectMenu(),s.createFixedLocationAutocomplete()):typeof e.error.global[0]!="undefined"&&s.getGlobalNotice().removeClass("chbs-hidden").html(e.error.global[0].message),s.preloader(!1)})}),s.e(".chbs-main-content-step-3").on("click",".chbs-sign-up-password-generate",function(e){e.preventDefault();var t=new CHBSHelper,n=t.generatePassword(8);s.e('input[name="chbs_client_sign_up_password"],input[name="chbs_client_sign_up_password_retype"]').val(n)}),s.e(".chbs-main-content-step-3").on("click",".chbs-sign-up-password-show",function(e){e.preventDefault();var t=s.e('input[name="chbs_client_sign_up_password"]');t.attr("type",t.attr("type")==="password"?"text":"password")}),e(document).bind("keypress",function(t){if(parseInt(t.which,10)===13)switch(e(t.target).attr("name")){case"chbs_client_sign_in_login":case"chbs_client_sign_in_password":s.e(".chbs-main-content-step-3 .chbs-button-sign-in").trigger("click");break}}),e(document).unbind("keydown").bind("keydown",function(t){switch(e(t.target).attr("name")){case"chbs_passenger_adult_service_type_1":case"chbs_passenger_adult_service_type_2":case"chbs_passenger_adult_service_type_3":case"chbs_passenger_children_service_type_1":case"chbs_passenger_children_service_type_2":case"chbs_passenger_children_service_type_3":if(e.inArray(parseInt(t.keyCode,10),[38,40])>-1){var n=parseInt(e(t.target).val(),10);isNaN(n)&&(n=0),parseInt(t.keyCode,10)===38?n=n+1>99?99:n+1:parseInt(t.keyCode,10)===40&&(n=n-1<0?0:n-1),e(t.target).val(parseInt(n))}break}}),s.e(".chbs-main-content-step-2").on("click",".chbs-quantity-section .chbs-quantity-section-button",function(){var n,o,i,a,s=e(this).parent().children('input[type="text"]');if(parseInt(s.length,10)!==1)return;if(o=parseInt(e(this).attr("data-step"),10),n=parseInt(s.val(),10),i=1,a=parseInt(s.attr("data-quantity-max"),10),n+=o,n<i||n>a)return;s.val(n),e(this).parents("li:first").find(".chbs-column-3 .chbs-button").removeClass("chbs-state-selected"),e(this).parents("li:first").find(".chbs-column-3 .chbs-button:first").trigger("click")}),s.e(".chbs-main-content-step-2 .chbs-vehicle-list").on("click",".chbs-pagination a",function(t){t.preventDefault();var o,r,c,n=0,a=parseInt(e(this).parent(".chbs-pagination").attr("data-vehicle_per_page"),10),l=s.e(".chbs-vehicle-list>ul>li").length,i=0;if(s.e(".chbs-vehicle-list>ul>li").each(function(){n++,!e(this).hasClass("chbs-hidden")&&i===0&&(i=n)}),r=parseInt(e(this).attr("href").substr(1),10),o=i+r*a,c=o+a,o>l)return;if(o<=0)return;n=0,s.e(".chbs-vehicle-list>ul>li").each(function(){n++,e(this).addClass("chbs-hidden"),n>=o&&n<c&&e(this).removeClass("chbs-hidden")})}),s.createLabelTooltip(),s.googleMapCreate(),s.googleMapInit(),l=s.e('[name="chbs_route_service_type_3"]>option:first'),parseInt(l.val(),10)===-1&&typeof c!="undefined"&&(d=[{lat:c.lat(),lng:c.lng()}],l.attr("data-coordinate",JSON.stringify(d))),s.googleMapCreateRoute(function(){parseInt(t.urlParam("widget_submit"),10)===1&&parseInt(t.urlParam("widget_second_step"),10)===1?s.goToStep(1,function(){i.removeClass("chbs-hidden"),s.createStickySidebar(),e(window).scroll()}):i.removeClass("chbs-hidden"),s.googleMapStartCustomizeHeight()}),s.moveSubmitButton(),s.setBidPriceVehicle(),s.showRideInfo()},this.showRideInfo=function(){var e=s.getServiceTypeId();parseInt(e,10)===2?s.e(".chbs-ride-info>div:first").addClass("chbs-hidden"):s.e(".chbs-ride-info>div:first").removeClass("chbs-hidden")},this.myLocationSuccess=function(e){s.e(".chbs-my-location-link").on("click",function(){var n={lat:e.coords.latitude,lng:e.coords.longitude},t=s.e('input[name="chbs_pickup_location_coordinate_service_type_'+s.getServiceTypeId()+'"]');t.val(JSON.stringify(n)),s.googleMapSetAddress(t,function(){s.googleMapCreate(),s.googleMapCreateRoute()},!0)})},this.myLocationError=function(e){console.log(e)},this.getVehicleSelectedId=function(){var e=parseInt(s.e(".chbs-vehicle .chbs-vehicle-content-header .chbs-button.chbs-state-selected").parents(".chbs-vehicle").attr("data-id"),10);return e},this.setBidPriceVehicle=function(){s.e(".chbs-main-content-step-2"),s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle-content-price-bid>div:first-child>a",function(t){t.preventDefault(),e(this).parent("div").addClass("chbs-hidden"),e(this).parent("div").next("div").removeClass("chbs-hidden")}),s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle-content-price-bid>div+div>input+a",function(t){var n=e(this).prev("input");t.preventDefault(),s.setAction("vehicle_bid_price_check"),s.preloader(!0),s.post(s.e('form[name="chbs-form"]').serialize(),function(e){s.preloader(!1),typeof e.html!="undefined"&&(typeof e.bid_vehicle_min_value!="undefined"?confirm(e.bid_question)?(n.val(e.bid_vehicle_min_value),s.preloader(!0),s.post(s.e('form[name="chbs-form"]').serialize(),function(e){s.preloader(!1),typeof e.html!="undefined"&&s.e(".chbs-summary-price-element").replaceWith(e.html)})):(s.e(".chbs-summary-price-element").replaceWith(e.html),typeof e.bid_notice!="undefined"&&alert(e.bid_notice)):(s.e(".chbs-summary-price-element").replaceWith(e.html),typeof e.bid_notice!="undefined"&&alert(e.bid_notice)))})}),s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle-content-price-bid>div+div>input+a+a",function(t){t.preventDefault(),e(this).parent("div").addClass("chbs-hidden"),e(this).parent("div").prev("div").removeClass("chbs-hidden"),e(this).parent("div").find('input[type="text"]').val(""),s.setAction("vehicle_bid_price_check"),s.post(s.e('form[name="chbs-form"]').serialize(),function(e){typeof e.html!="undefined"&&s.e(".chbs-summary-price-element").replaceWith(e.html)})})},this.setPayment=function(){var e=parseInt(s.e('input[name="chbs_payment_id"]').val(),10);e>0&&s.e('.chbs-payment>li>a[data-payment-id="'+e+'"]').addClass("chbs-state-selected")},this.moveSubmitButton=function(){if(i.hasClass("chbs-widget")&&i.hasClass("chbs-widget")&&i.hasClass("chbs-widget-style-2")){var e=s.e(".chbs-main-content-step-1 .chbs-button-widget-submit").parent();e.clone().appendTo(s.e("#panel-1")),e.clone().appendTo(s.e("#panel-2")),e.clone().appendTo(s.e("#panel-3")),e.remove()}},this.convertTimeToMinute=function(e){return e=e.split(":"),e[0]*60+e[1]},this.createLabelTooltip=function(){s.e(".chbs-tooltip").qtip({style:{classes:"chbs-qtip chbs-qtip-success"},position:{my:"bottom left",at:"top left",container:i}})},this.setTimepicker=function(t){(parseInt(o.timepicker_dropdown_list_enable,10)===1||t.hasClass("chbs-timepicker-form-element"))&&e(".ui-timepicker-wrapper").css({opacity:1,width:t.parent("div").outerWidth()+1})},this.createFormElementFieldDatePicker=function(){var t={autoSize:!0,dateFormat:o.date_format_js,beforeShow:function(t,n){var i=new CHBSHelper,s=i.getValueFromClass(e(n.dpDiv),"chbs-booking-form-id-");s!==!1&&e(n.dpDiv).removeClass("chbs-booking-form-id-"+s),e(n.dpDiv).addClass("chbs-booking-form-id-"+o.booking_form_id).addClass("chbs-datepicker")}};s.e(".chbs-datepicker.chbs-datepicker-form-element").datepicker(t)},this.createFormElementFieldTimePicker=function(){s.e(".chbs-main-content").on("click",".chbs-timepicker.chbs-timepicker-form-element",function(){var n={showOn:[],appendTo:i,showOnFocus:!1,timeFormat:o.time_format};e(this).timepicker(n),e(this).val("").timepicker("show"),e(this).blur(),s.setTimepicker(e(this))})},this.createFormElementFieldAutocomplete=function(){var t=new CHBSHelper;s.e(".chbs-autocomplete-form-element").each(function(){var i,a,r="chbs_autocomplete_form_element_"+t.getRandomString(16);e(this).attr("id",r),i=e(this),a=new google.maps.places.Autocomplete(document.getElementById(r),n),a.addListener("place_changed",function(){var r,n=a.getPlace();if(!n.geometry)return alert(o.message.place_geometry_error),i.val(""),!1;r={lat:n.geometry.location.lat(),lng:n.geometry.location.lng(),address:s.removeDoubleQuote(i.val()),zip_code:s.getZipCode(n)},e(i).siblings('input[type="hidden"]').val(JSON.stringify(r))})})},this.createFileField=function(){s.e('input[type="file"]').each(function(){var t=e(this);e(this).fileupload({url:o.ajax_url,dataType:"json",formData:{action:"chbs_file_upload"},done:function(e,n){s.setFileUploadField(t,!0,n.result)}}),e(this).parent(".chbs-file-upload").next(".chbs-file-remove").children("span:last-child").on("click",function(e){e.preventDefault(),s.setFileUploadField(t,!1,[])})})},this.setFileUploadField=function(e,t,n){var o=e.attr("name"),i=s.e('input[name="'+o+'"]');t?(i.parent(".chbs-file-upload").addClass("chbs-hidden"),i.parent(".chbs-file-upload").next(".chbs-file-remove").removeClass("chbs-hidden").find("span>span").html(n.name)):(i.parent(".chbs-file-upload").removeClass("chbs-hidden"),i.parent(".chbs-file-upload").next(".chbs-file-remove").addClass("chbs-hidden").find("span>span").html(""),n={name:"",type:"",tmp_name:""}),s.e('input[name="'+o+'_name"]').val(n.name),s.e('input[name="'+o+'_type"]').val(n.type),s.e('input[name="'+o+'_tmp_name"]').val(n.tmp_name)},this.createSelectMenu=function(t=!0){var n,o,r,c,a="select";t&&(a+=":not(.chbs-selectmenu-disable)"),s.e(a).selectmenu({appendTo:i,open:function(){var o=e(this),i=e("#"+o.attr("id")+"-menu").parent("div"),s=o.parents(".chbs-form-field:first"),a=parseInt(i.css("left"),10)-1,r=parseInt(s.css("border-left-width"),10)+parseInt(s.css("border-right-width"),10),c=s[0].getBoundingClientRect().width-r;i.css({width:c+2,left:a})},change:function(){var i,a,r,o=e(this).attr("name");if(o==="chbs_waypoint_duration_service_type_1[]"&&s.reCalculateRoute(),o==="chbs_route_service_type_3"&&(s.googleMapCreate(),s.googleMapCreateRoute()),e.inArray(o,["chbs_transfer_type_service_type_1","chbs_transfer_type_service_type_3"])>-1&&(i=s.e('[name="chbs_return_date_service_type_'+s.getServiceTypeId()+'"]').parent("div").parent("div"),parseInt(e(this).val(),10)===3?i.removeClass("chbs-hidden"):i.addClass("chbs-hidden")),e.inArray(o,["chbs_extra_time_service_type_1","chbs_transfer_type_service_type_1","chbs_duration_service_type_2","chbs_extra_time_service_type_3","chbs_transfer_type_service_type_3"])>-1&&s.reCalculateRoute(),o==="chbs_navigation_responsive"){if(a=parseInt(e(this).val(),10),r=parseInt(s.e('input[name="chbs_step"]').val(),10),a-r===0)return;s.goToStep(a-r)}e.inArray(o,["chbs_vehicle_passenger_count","chbs_vehicle_bag_count","chbs_vehicle_standard","chbs_vehicle_category"])>-1&&(s.setAction("vehicle_filter"),s.e(".chbs-vehicle-list").children().addClass("chbs-hidden"),s.e(".chbs-vehicle-list").addClass("chbs-preloader-1"),s.post(s.e('form[name="chbs-form"]').serialize(),function(e){s.getGlobalNotice().addClass("chbs-hidden");var t=s.e(".chbs-vehicle-list");t.html("").removeClass("chbs-preloader-1"),typeof e.error!="undefined"&&typeof e.error.global!="undefined"?s.getGlobalNotice().removeClass("chbs-hidden").html(e.error.global[0].message):(t.html(e.html),s.recalculateVehiclePrice(e,1)),s.e(".chbs-vehicle-list").find(".chbs-button.chbs-button-style-2").removeClass("chbs-state-selected"),s.preloadVehicleImage(),s.e('input[name="chbs_vehicle_id"]').val(0),s.createSummaryPriceElement()})),e.inArray(o,["chbs_fixed_location_pickup_service_type_1","chbs_fixed_location_dropoff_service_type_1","chbs_fixed_location_pickup_service_type_2","chbs_fixed_location_dropoff_service_type_3"]>-1)&&s.googleMapSetAddress(e(this),function(){s.googleMapCreate(),s.googleMapCreateRoute()}),e.inArray(o,["chbs_fixed_location_pickup_service_type_1","chbs_fixed_location_pickup_service_type_2"]>-1)&&s.checkFixedLocationPickup(o),e.inArray(o,["chbs_fixed_location_dropoff_service_type_1"]>-1)&&s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_1"),e.inArray(o,["chbs_fixed_location_dropoff_service_type_2"]>-1)&&s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_2")}}),s.e(".ui-selectmenu-button .ui-icon.ui-icon-triangle-1-s").attr("class","chbs-meta-icon-arrow-vertical-large"),s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_1"),s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_2"),n=[1,3];for(r in n)o=s.e('[name="chbs_transfer_type_service_type_'+n[r]+'"]'),o.length===1&&parseInt(o.val(),10)===3&&(c=s.e('[name="chbs_return_date_service_type_'+n[r]+'"]'),c.parents(".chbs-form-field").parent(".chbs-clear-fix").removeClass("chbs-hidden"))},this.getFixedLocationSource=function(t){var n=[];return e(t).next("select").find('option:not([disabled="disabled"])').each(function(e,t){n.push({label:t.text,value:t.value})}),n},this.createFixedLocationAutocomplete=function(){s.e(".chbs-form-field-location-fixed-autocomplete").each(function(t,n){var o=s.getFixedLocationSource(n);o.length&&(e(n).autocomplete({appendTo:i,source:o,minLength:0,focus:function(e){e.preventDefault()},select:s.handleFixedLocationAutocompleteChange,change:s.handleFixedLocationAutocompleteChange}).focus(function(){e(this).autocomplete("search")}),e.ui.autocomplete.filter=function(t,n){var s=new RegExp("^"+e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})})})},this.handleFixedLocationAutocompleteChange=function(t,n){t.preventDefault();var i=e(t.target).next("select"),o=i.attr("name");n.item==null?(e(t.target).val(""),i.val("")):(e(t.target).val(n.item.label),i.val(n.item.value)),e.inArray(o,["chbs_fixed_location_pickup_service_type_1","chbs_fixed_location_dropoff_service_type_1","chbs_fixed_location_pickup_service_type_2","chbs_fixed_location_dropoff_service_type_3"]>-1)&&s.googleMapSetAddress(i,function(){s.googleMapCreate(),s.googleMapCreateRoute()}),e.inArray(o,["chbs_fixed_location_pickup_service_type_1","chbs_fixed_location_pickup_service_type_2"]>-1)&&s.checkFixedLocationPickup(o),e.inArray(o,["chbs_fixed_location_dropoff_service_type_1"]>-1)&&s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_1"),e.inArray(o,["chbs_fixed_location_dropoff_service_type_2"]>-1)&&s.checkFixedLocationPickup("chbs_fixed_location_pickup_service_type_2")},this.checkFixedLocationPickup=function(t){var n,a,i=t.replace("pickup","dropoff"),o=s.e('[name="'+i+'"]');o.children("option").removeAttr("disabled");try{o.selectmenu("refresh")}catch{}if(n=s.e('select[name="'+t+'"]').children("option:selected").attr("data-location"),typeof n=="undefined")return;if(n=JSON.parse(n),!n.dropoff_disable.length)return;for(a in n.dropoff_disable)o.children('option[value="'+n.dropoff_disable[a]+'"]').attr("disabled","disabled").removeAttr("selected");try{o.selectmenu("refresh")}catch{}s.e(".chbs-form-field-location-fixed-autocomplete").each(function(t,n){var o=s.getFixedLocationSource(n);e(n).autocomplete({source:o})})},this.setMainNavigation=function(){var o,n=parseInt(s.e('input[name="chbs_step"]').val(),10),t=s.e(".chbs-main-navigation-default").find("li");t.removeClass("chbs-state-selected").removeClass("chbs-state-completed"),t.filter('[data-step="'+n+'"]').addClass("chbs-state-selected"),o=0,t.each(function(){if(++o>=n)return;e(this).addClass("chbs-state-completed")})},this.getServiceTypeId=function(){return parseInt(s.e(".ui-tabs .ui-tabs-active").attr("data-id"),10)},this.setServiceTypeId=function(e){s.e('input[name="chbs_service_type_id"]').val(e)},this.setAction=function(e){s.e('input[name="action"]').val("chbs_"+e)},this.e=function(e){return i.find(e)},this.recalculateVehiclePrice=function(t,n){if(parseInt(t.booking_summary_hide_fee,10)===1&&parseInt(n,10)===1){var i,a,o=[];if(s.e(".chbs-vehicle-list>ul>li").each(function(){var n=new CHBSHelper,t=e(this).children("div:first");!n.isEmpty(t.attr("data-base_location_cooridnate_lat"))&&!n.isEmpty(t.attr("data-base_location_cooridnate_lng"))&&o.push({id:t.attr("data-id"),lat:t.attr("data-base_location_cooridnate_lat"),lng:t.attr("data-base_location_cooridnate_lng")})}),o.length){s.e(".chbs-vehicle-list").children().addClass("chbs-hidden"),s.e(".chbs-vehicle-list").addClass("chbs-preloader-1"),i=0;for(a in o)s.calculateBaseLocationDistance(function(e){i++;var t=s.e('.chbs-vehicle-list .chbs-vehicle[data-id="'+e.id+'"]');if(t.find('[name="chbs_base_location_vehicle_distance['+e.id+']"]').val(e.distance),t.find('[name="chbs_base_location_vehicle_return_distance['+e.id+']"]').val(e.return_distance),i===o.length){s.goToStep(0);return}},o[a])}}},this.goToStep=function(t,n,r=!0){s.preloader(!0);var l,u,h,f,p,g,m=s.e('input[name="chbs_step"]'),c=s.e('input[name="chbs_step_request"]');if(parseInt(o.recaptcha.enable,10)===1&&(f=parseInt(m.val(),10)+t,f>=1&&r)){l=parseInt(o.recaptcha.api_type,10)===1?grecaptcha:grecaptcha.enterprise,l.ready(function(){l.execute(o.recaptcha.site_key).then(function(e){s.e('[name="chbs_recaptcha_token"]').val(e),s.goToStep(t,n,!1)})});return}s.setAction("go_to_step"),s.setServiceTypeId(s.getServiceTypeId()),c.val(parseInt(m.val(),10)+t),u=s.getServiceTypeId(),parseInt(c.val(),10)===2&&(h=parseInt(s.e('[name="chbs_passenger_adult_service_type_'+u+'"]').val(),10)+parseInt(s.e('[name="chbs_passenger_children_service_type_'+u+'"]').val(),10),h>0&&s.e('[name="chbs_vehicle_passenger_count"]').val(h)),parseInt(c.val(),10)===4&&d&&(p=s.e('input[name="chbs_client_contact_detail_phone_number"]'),g=d.getNumber(),p.val(g)),s.post(s.e('form[name="chbs-form"]').serialize(),function(t){var r,c,l,d,u,h,m,f,p,g=s.e('input[name="chbs_step"]').val();switch(t.step=parseInt(t.step,10),s.getGlobalNotice().addClass("chbs-hidden"),s.e(".chbs-main-content>div").css("display","none"),s.e(".chbs-main-content>div:eq("+(t.step-1)+")").css("display","block"),s.e('input[name="chbs_step"]').val(t.step),s.setMainNavigation(),s.googleMapDuplicate(-1),google.maps.event.trigger(a,"resize"),s.e('select[name="chbs_navigation_responsive"]').val(t.step),s.e('select[name="chbs_navigation_responsive"]').selectmenu("refresh"),parseInt(t.step,10)===1?s.googleMapStartCustomizeHeight():s.googleMapStopCustomizeHeight(),parseInt(t.step,10)){case 2:if(typeof t.redirect_to_url_address!="undefined"){e("body").css({display:"none"}),window.location.href=t.redirect_to_url_address;break}s.e('.chbs-vehicle-filter>.chbs-form-field>select[name="chbs_vehicle_passenger_count"]').replaceWith(t.vehicle_passenger_filter_field),typeof t.vehicle!="undefined"&&(s.e(".chbs-vehicle-list").removeClass("chbs-preloader-1"),s.e(".chbs-vehicle-list").html(t.vehicle),s.recalculateVehiclePrice(t,g)),typeof t.booking_extra!="undefined"&&s.e(".chbs-booking-extra").html(t.booking_extra),typeof t.summary!="undefined"&&s.e(".chbs-main-content-step-2>.chbs-layout-25x75 .chbs-layout-column-left:first").html(t.summary[0]),s.preloadVehicleImage(),s.createVehicleGallery(),s.createSelectMenu(),s.createFixedLocationAutocomplete(),s.manageBookingExtra();break;case 3:typeof t.client_form_sign_in!="undefined"&&typeof t.client_form_sign_up!="undefined"&&(s.e(".chbs-main-content-step-3 .chbs-client-form").html(""),typeof t.client_form_sign_in!="undefined"&&s.e(".chbs-main-content-step-3 .chbs-client-form").prepend(t.client_form_sign_in),typeof t.client_form_sign_up!="undefined"&&s.e(".chbs-main-content-step-3 .chbs-client-form").append(t.client_form_sign_up),typeof t.payment_form!="undefined"&&s.e(".chbs-main-content-step-3 .chbs-payment-form").html(t.payment_form)),typeof t.summary!="undefined"&&s.e(".chbs-main-content-step-3>.chbs-layout-25x75 .chbs-layout-column-left:first").html(t.summary[0]),s.setPayment(),s.createFileField(),s.createSelectMenu(),s.createFixedLocationAutocomplete(),s.createFormElementFieldDatePicker(),s.createFormElementFieldTimePicker(),s.createFormElementFieldAutocomplete();break;case 4:typeof t.summary!="undefined"&&(s.e(".chbs-main-content-step-4>.chbs-layout-33x33x33>.chbs-layout-column-left").html(t.summary[0]),s.e(".chbs-main-content-step-4>.chbs-layout-33x33x33>.chbs-layout-column-center").html(t.summary[1]),s.e(".chbs-main-content-step-4>.chbs-layout-33x33x33>.chbs-layout-column-right").html(t.summary[2])),s.e(".chbs-agreement-header,.chbs-agreement").remove(),typeof t.agreement_html!="undefined"&&s.e(".chbs-main-content-step-4>.chbs-layout-33x33x33").after(t.agreement_html);break}if(s.createPhoneField(),s.createLabelTooltip(),s.createStickySidebar(),e(window).scroll(),e.inArray(t.step,[4])>-1&&s.googleMapDuplicate(t.step),e(".qtip").remove(),typeof t.error!="undefined"&&(typeof t.error.global[0]!="undefined"&&s.getGlobalNotice().removeClass("chbs-hidden").html(t.error.global[0].message),typeof t.error.local!="undefined"))for(f in t.error.local)c=t.error.local[f].field.split("-"),isNaN(c[1])?u='[name="'+c[0]+'"]:eq(0)':u='[name="'+c[0]+'[]"]:eq('+c[1]+")",h=s.e(u).prevAll("label"),h.qtip({show:{target:e(this)},style:{classes:t.error===1?"chbs-qtip chbs-qtip-error":"chbs-qtip chbs-qtip-success"},content:{text:t.error.local[f].message},position:{my:o.rtl_mode?"bottom right":"bottom left",at:o.rtl_mode?"top right":"top left",container:h.parents('[name="chbs-form"]')}}).qtip("show");if(parseInt(t.step,10)===5)if(s.e(".chbs-main-navigation-default").addClass("chbs-hidden"),s.e(".chbs-main-navigation-responsive").addClass("chbs-hidden"),typeof t.error!="undefined")s.getGlobalNotice().removeClass("chbs-hidden").html(t.error.global[0].message);else switch(typeof t.redirect_to_woocommerce_cart_enable!="undefined"&&parseInt(t.redirect_to_woocommerce_cart_enable,10)===1&&(e("body").css("display","none"),window.location.href=t.redirect_to_woocommerce_cart_url_address),e.inArray(parseInt(t.payment_id,10),[1,2,3,4,5])>-1&&(r=new CHBSHelper,r.isEmpty(t.payment_info)||s.e(".chbs-booking-complete-payment-"+t.payment_prefix).append("<p>"+t.payment_info+"</p>")),parseInt(t.payment_id,10)){case-2:r.isEmpty(t.payment_disable_success_url_address)||(e("body").css("display","none"),window.location.href=t.payment_disable_success_url_address),s.e(".chbs-booking-complete-payment-disable").css("display","block");break;case-1:parseInt(t.thank_you_page_enable,10)!==1?(e("body").css("display","none"),window.location.href=t.payment_url):(s.e(".chbs-booking-complete-payment-woocommerce").css("display","block"),s.e(".chbs-booking-complete-payment-woocommerce>a").attr("href",t.payment_url));break;case 1:r.isEmpty(t.payment_cash_success_url_address)||(e("body").css("display","none"),window.location.href=t.payment_cash_success_url_address),s.e(".chbs-booking-complete-payment-cash").css("display","block");break;case 2:e("body").css("display","none"),e.getScript("https://js.stripe.com/v3/",function(){var n,i,a=Stripe(t.stripe_publishable_key),o=s.e(".chbs-booking-complete-payment-stripe");s.e(".chbs-booking-complete").on("click",".chbs-booking-complete-payment-stripe a",function(e){e.preventDefault(),a.redirectToCheckout({sessionId:t.stripe_session_id}).then(function(){})}),n=parseInt(t.stripe_redirect_duration,10),n<=0?o.find("a").trigger("click"):(e("body").css("display","block"),o.css("display","block"),i=setInterval(function(){n--,o.find("div>span").html(n),n===0&&(clearInterval(i),o.find("a").trigger("click"))},1e3))});break;case 3:e("body").css("display","none"),l=s.e(".chbs-booking-complete-payment-paypal"),s.e(".chbs-booking-complete").on("click",".chbs-booking-complete-payment-paypal a",function(e){e.preventDefault();var o,n=s.e('form[name="chbs-form-paypal"]');for(o in t.form)n.find('input[name="'+o+'"]').val(t.form[o]);n.submit()}),d=parseInt(t.payment_paypal_redirect_duration,10),d<=0?l.find("a").trigger("click"):(e("body").css("display","block"),l.css("display","block"),p=setInterval(function(){d--,l.find("div>span").html(d),d===0&&(clearInterval(p),l.find("a").trigger("click"))},1e3));break;case 4:r.isEmpty(t.payment_wire_transfer_success_url_address)||(e("body").css("display","none"),window.location.href=t.payment_wire_transfer_success_url_address),s.e(".chbs-booking-complete-payment-wire-transfer").css("display","block");break;case 5:r.isEmpty(t.payment_credit_card_pickup_success_url_address)||(e("body").css("display","none"),window.location.href=t.payment_credit_card_pickup_success_url_address),s.e(".chbs-booking-complete-payment-credit-card-pickup").css("display","block");break}m=20,e("#wpadminbar").length===1&&(m+=e("#wpadminbar").height()),e.scrollTo(i,{offset:-1*m}),typeof n!="undefined"&&n(),s.preloader(!1)})},this.createPhoneField=function(){var t=s.e('input[name="chbs_client_contact_detail_phone_number"]'),e=s.e('input[name="chbs_client_contact_detail_phone_number_placeholder"]');parseInt(e.length,10)===1&&(d=window.intlTelInput(e[0],{initialCountry:o.client_country_code,separateDialCode:!0}),d.setNumber(t.val()),e[0].addEventListener("countrychange",function(){var e=d.getNumber();t.val(e)}))},this.manageBookingExtra=function(){var n,i,a,t=s.e(".chbs-booking-extra-list"),o=s.e(".chbs-booking-extra-category-list");if(t.length!==1)return;parseInt(o.length)===1&&(t.addClass("chbs-hidden"),o.find(">div>a").off("click"),o.find(">div>a").on("click",function(n){n.preventDefault();var o=e(this).attr("data-category_id");if(t=s.e(".chbs-booking-extra-list"),e(this).next(".chbs-booking-extra-list").length===1&&!e(this).next(".chbs-booking-extra-list").hasClass("chbs-hidden")){e(this).next(".chbs-booking-extra-list").addClass("chbs-hidden");return}t.find("li").each(function(){e.inArray(o,e(this).attr("data-category_id").split(","))>-1?e(this).removeClass("chbs-hidden-by-category"):e(this).addClass("chbs-hidden-by-category")}),e(this).after(t),t.removeClass("chbs-hidden")})),a=s.e('[name="chbs_vehicle_id"]').val(),t=s.e(".chbs-booking-extra-list"),t.find("li:not(.chbs-hidden-by-category)").each(function(){var t=e(this).attr("data-vehicle_id").split(",");e.inArray("-1",t)>-1||e.inArray(a,t)>-1?e(this).removeClass("chbs-hidden"):(e(this).addClass("chbs-hidden"),e(this).find(".chbs-button.chbs-button-style-2").removeClass(".chbs-state-selected"))}),t=s.e(".chbs-booking-extra-list"),i=[],t.find(".chbs-button.chbs-button-style-2").each(function(){e(this).hasClass("chbs-state-selected")&&i.push(e(this).attr("data-value"))}),n=[i.join(","),s.e('input[name="chbs_booking_extra_id"]').val()],new String(n[0])!==new String(n[1])&&(s.e('input[name="chbs_booking_extra_id"]').val(n[0]),s.createSummaryPriceElement())},this.post=function(t,n){e.post(o.ajax_url,t,function(e){n(e)},"json")},this.preloader=function(e){s.e("#chbs-preloader").css("display",e?"block":"none")},this.preloadVehicleImage=function(){try{s.e(".chbs-vehicle-list .chbs-vehicle-image img").one("load",function(){e(this).parent(".chbs-vehicle-image").animate({opacity:1},300)}).each(function(){this.complete&&e(this).load()})}catch{}},this.createVehicleGallery=function(){s.e(".chbs-main-content-step-2").on("click",".chbs-vehicle-list .chbs-vehicle-image img",function(t){t.preventDefault();var n=e(this).parents(".chbs-vehicle-image:first").nextAll(".chbs-vehicle-gallery");parseInt(n.length,10)===1&&e.fancybox.open(n.find("img"))})},this.googleMapStartCustomizeHeight=function(){if(parseInt(o.widget.mode,10)===1)return;if(parseInt(s.e('input[name="chbs_step"]').val(),10)!==1)return;if(u>0)return;u=window.setInterval(function(){s.googleMapCustomizeHeight()},500)},this.googleMapStopCustomizeHeight=function(){if(parseInt(o.widget.mode,10)===1)return;if(parseInt(s.e('input[name="chbs_step"]').val(),10)!==1)return;clearInterval(u),s.e("#chbs_google_map").height("420px"),u=0},this.googleMapCustomizeHeight=function(){if(parseInt(o.widget.mode,10)===1)return;if(parseInt(s.e('input[name="chbs_step"]').val(),10)!==1)return;var e=s.e(".chbs-ride-info"),t=s.e(".chbs-main-content-step-1>.chbs-layout-50x50>.chbs-layout-column-left"),n=new CHBSHelper;n.isMobile()?s.e("#chbs_google_map").height("420px"):s.e("#chbs_google_map").height(parseInt(t.actual("height"),10)-parseInt(e.actual("height"),10)),google.maps.event.trigger(a,"resize")},this.googleMapDuplicate=function(e){if(e===4){var t=s.e(".chbs-google-map>#chbs_google_map");t.children("div").length&&s.e(".chbs-google-map-summary").append(t)}else t=s.e(".chbs-google-map-summary>#chbs_google_map"),t.children("div").length&&s.e(".chbs-google-map").append(t);google.maps.event.trigger(a,"resize");try{r.setDirections(f),r.setRouteIndex(s.getRouteIndex()),a.setCenter(r.getDirections().routes[s.getRouteIndex()].bounds.getCenter())}catch{}},this.googleMapSetAddress=function(e,t,n=!1){var o,a,i=new CHBSHelper;if(e.prop("tagName").toLowerCase()==="select"){t();return}if(o=JSON.parse(e.val()),i.isEmpty(o.lat)||i.isEmpty(o.lng))return;a=new google.maps.Geocoder,a.geocode({location:new google.maps.LatLng(o.lat,o.lng)},function(i,a){if(a==="OK"&&i[0]){if(o.address=s.removeDoubleQuote(i[0].formatted_address),n){var r=e.parent(".chbs-form-field-location-autocomplete").children('input[type="text"]');r.length===1&&r.val(o.address)}e.val(JSON.stringify(o)),t()}})},this.googleMapAutocompleteCreate=function(t){if(t.is("[readonly]"))return;var n,i,a,r,c,l="chbs_location_"+(new CHBSHelper).getRandomString(16);t.attr("id",l).on("keypress",function(e){if(e.which===13)return e.preventDefault(),!1}),t.on("change",function(){e.trim(e(this).val()).length||(t.siblings('input[type="hidden"]').val(""),s.googleMapCreate(),s.googleMapCreateRoute())}),n={},i=new CHBSHelper,r=new String(t.attr("name")),r.indexOf("pickup")>-1&&parseInt(o.driving_zone.pickup.enable)===1&&(!i.isEmpty(o.driving_zone.pickup.area.coordinate.lat)&&!i.isEmpty(o.driving_zone.pickup.area.coordinate.lat)&&parseInt(o.driving_zone.pickup.area.radius,10)>=0&&(a=new google.maps.Circle({center:new google.maps.LatLng(o.driving_zone.pickup.area.coordinate.lat,o.driving_zone.pickup.area.coordinate.lng),radius:o.driving_zone.pickup.area.radius*1e3}),n.strictBounds=!0,n.bounds=a.getBounds()),o.driving_zone.pickup.country.length&&e.inArray(-1,o.driving_zone.pickup.country)===-1&&(n.componentRestrictions={},n.componentRestrictions.country=o.driving_zone.pickup.country)),r.indexOf("waypoint")>-1&&parseInt(o.driving_zone.waypoint.enable)===1&&(!i.isEmpty(o.driving_zone.waypoint.area.coordinate.lat)&&!i.isEmpty(o.driving_zone.waypoint.area.coordinate.lat)&&parseInt(o.driving_zone.waypoint.area.radius,10)>=0&&(a=new google.maps.Circle({center:new google.maps.LatLng(o.driving_zone.waypoint.area.coordinate.lat,o.driving_zone.waypoint.area.coordinate.lng),radius:o.driving_zone.waypoint.area.radius*1e3}),n.strictBounds=!0,n.bounds=a.getBounds()),o.driving_zone.waypoint.country.length&&e.inArray(-1,o.driving_zone.waypoint.country)===-1&&(n.componentRestrictions={},n.componentRestrictions.country=o.driving_zone.waypoint.country)),r.indexOf("dropoff")>-1&&parseInt(o.driving_zone.dropoff.enable,10)===1&&(!i.isEmpty(o.driving_zone.dropoff.area.coordinate.lat)&&!i.isEmpty(o.driving_zone.dropoff.area.coordinate.lat)&&parseInt(o.driving_zone.dropoff.area.radius,10)>=0&&(a=new google.maps.Circle({center:new google.maps.LatLng(o.driving_zone.dropoff.area.coordinate.lat,o.driving_zone.dropoff.area.coordinate.lng),radius:o.driving_zone.dropoff.area.radius*1e3}),n.strictBounds=!0,n.bounds=a.getBounds()),o.driving_zone.dropoff.country.length&&e.inArray(-1,o.driving_zone.dropoff.country)===-1&&(n.componentRestrictions={},n.componentRestrictions.country=o.driving_zone.dropoff.country)),n.fields=["address_components","geometry"],c=new google.maps.places.Autocomplete(document.getElementById(l),n),c.addListener("place_changed",function(){var a,r,l,i=c.getPlace();if(!i.geometry)return alert(o.message.place_geometry_error),t.val(""),!1;a={lat:i.geometry.location.lat(),lng:i.geometry.location.lng(),address:s.removeDoubleQuote(t.val()),zip_code:s.getZipCode(i)};for(r in i.address_components)if(e.inArray("locality",i.address_components[r].types)>-1){a.locality=i.address_components[r].long_name;break}l=t.siblings('input[type="hidden"]'),l.val(JSON.stringify(a)),s.googleMapCreate(),s.googleMapCreateRoute()})},this.getZipCode=function(e){for(var n,t=0;t<e.address_components.length;t++)for(n=0;n<e.address_components[t].types.length;n++)if(e.address_components[t].types[n]=="postal_code")return e.address_components[t].long_name;return""},this.googleMapInit=function(){if(!s.googleMapExist())return;parseInt(o.google_map_option.default_location.type,10)===1?navigator.geolocation?(s.googleMapSetDefaultLocation(),navigator.geolocation.getCurrentPosition(function(e){try{c=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),a.setCenter(c)}catch{}},function(){s.googleMapSetDefaultLocation()})):s.googleMapSetDefaultLocation():s.googleMapSetDefaultLocation()},this.googleMapSetDefaultLocation=function(){if(typeof c=="undefined"&&(c=new google.maps.LatLng(o.google_map_option.default_location.coordinate.lat,o.google_map_option.default_location.coordinate.lng)),s.getServiceTypeId()===3)return;var t=new CHBSHelper,e=[];e[0]=s.e('[name="chbs_pickup_location_coordinate_service_type_'+s.getServiceTypeId()+'"]').val(),e[1]=s.e('[name="chbs_dropoff_location_coordinate_service_type_'+s.getServiceTypeId()+'"]').val(),!t.isEmpty(e[0])&&!t.isEmpty(e[1])&&(c=new google.maps.LatLng(e[0],e[1]));try{a.setCenter(c)}catch{}},this.googleMapCreate=function(){if(s.e("#chbs_google_map").length!==1)return;r=new google.maps.DirectionsRenderer,m=new google.maps.DirectionsService;var t,n={draggable:o.google_map_option.draggable.enable,scrollwheel:o.google_map_option.scrollwheel.enable,mapTypeId:google.maps.MapTypeId[o.google_map_option.map_control.id],mapTypeControl:o.google_map_option.map_control.enable,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle[o.google_map_option.map_control.style],position:google.maps.ControlPosition[o.google_map_option.map_control.position]},zoom:o.google_map_option.zoom_control.level,zoomControl:o.google_map_option.zoom_control.enable,zoomControlOptions:{position:google.maps.ControlPosition[o.google_map_option.zoom_control.position]},streetViewControl:!1};a=new google.maps.Map(s.e("#chbs_google_map")[0],n),parseInt(o.google_map_option.traffic_layer.enable,10)===1&&(t=new google.maps.TrafficLayer,t.setMap(a)),r.setMap(a),s.googleMapDraggableLocationAllowed()?r.setOptions({draggable:!0,suppressMarkers:!1}):r.setOptions({draggable:!1,suppressMarkers:!0}),s.googleMapDraggableLocationAllowed()&&(a.addListener("click",function(e){var r,t=new CHBSHelper,i=s.e('[name="chbs_pickup_location_service_type_'+s.getServiceTypeId()+'"]'),n=i.siblings('input[type="hidden"]'),a=s.e('[name="chbs_dropoff_location_service_type_'+s.getServiceTypeId()+'"]'),o=a.siblings('input[type="hidden"]');if(!t.isEmpty(n.val())&&!t.isEmpty(o.val()))return;r=new google.maps.Geocoder,r.geocode({location:e.latLng},function(r,c){if(c==="OK"&&r[0]){var l=s.removeDoubleQuote(r[0].formatted_address),d={lat:e.latLng.lat(),lng:e.latLng.lng(),address:s.removeDoubleQuote(r[0].formatted_address)};t.isEmpty(n.val())?(i.val(l),n.val(JSON.stringify(d))):t.isEmpty(o.val())&&(a.val(l),o.val(JSON.stringify(d))),s.googleMapCreate(),s.googleMapCreateRoute()}})}),r.addListener("directions_changed",function(){var n,o,i,a,c,l,d,u,h,m,p=new CHBSHelper,f=new google.maps.Geocoder,v=r.getDirections(),g=v.routes[s.getRouteIndex()],t=[];if(g.legs.forEach(function(e,n){parseInt(n,10)===0&&t.push({lat:e.start_location.lat(),lng:e.start_location.lng()}),e.via_waypoints.forEach(function(e){t.push({lat:e.lat(),lng:e.lng()})}),t.push({lat:e.end_location.lat(),lng:e.end_location.lng()})}),d=t.length,m=s.e('[name="chbs_waypoint_location_service_type_'+s.getServiceTypeId()+'[]"]'),a=[],a.push(s.e('[name="chbs_pickup_location_service_type_'+s.getServiceTypeId()+'"]')),s.e('[name="chbs_waypoint_location_service_type_'+s.getServiceTypeId()+'[]"]').each(function(t,n){t>0&&a.push(e(n))}),a.push(s.e('[name="chbs_dropoff_location_service_type_'+s.getServiceTypeId()+'"]')),u=a.length,d>u)for(o=1;o<d-1;o++)h=!1,m.each(function(n,s){if(n>0){var i,a=e(s).siblings('input[type="hidden"]').val();if(!p.isEmpty(a)&&(i=JSON.parse(a),i.lat==t[o].lat&&i.lng==t[o].lng))return h=!0,!1}}),h||(l=o,f.geocode({location:new google.maps.LatLng(t[l].lat,t[l].lng)},function(e,t){if(!(t==="OK"&&e[0]))return;var n,o,i=s.removeDoubleQuote(e[0].formatted_address),a={lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),address:s.removeDoubleQuote(e[0].formatted_address)};s.e(".chbs-location-add").eq(l).trigger("click"),n=s.e('[name="chbs_waypoint_location_service_type_'+s.getServiceTypeId()+'[]"]').eq(l),o=n.siblings('input[type="hidden"]'),n.val(i),o.val(JSON.stringify(a)),s.googleMapCreate(),s.googleMapCreateRoute()}));else n=!1,i=0,a.forEach(function(e,s){var r,a=new CHBSHelper,o=e.siblings('input[type="hidden"]').val();a.isEmpty(o)&&u===2&&s===1&&!(t[0].lat==t[1].lat&&t[0].lng==t[1].lng)?(n=e,r={lat:t[1].lat,lng:t[1].lng},e.siblings('input[type="hidden"]').val(JSON.stringify(r))):a.isEmpty(o)||(o=JSON.parse(o),o.lat==t[i].lat&&o.lng==t[i].lng||(n=e,o.lat=t[i].lat,o.lng=t[i].lng,e.siblings('input[type="hidden"]').val(JSON.stringify(o))),i++)}),n!=!1&&(c=JSON.parse(n.siblings('input[type="hidden"]').val()),f.geocode({location:new google.maps.LatLng(c.lat,c.lng)},function(e,t){if(t==="OK"&&e[0]){var o=s.removeDoubleQuote(e[0].formatted_address);n.val(o),c.address=o,n.siblings('input[type="hidden"]').val(JSON.stringify(c))}}),s.googleMapCreate(),s.googleMapCreateRoute())}))},this.getCoordinate=function(t=!1){var n,a,c,o=new CHBSHelper,r=new Array,i=s.getServiceTypeId(),l=s.e("#panel-"+i).children(".chbs-form-field-location-autocomplete,.chbs-form-field-location-fixed");if(i===1||i===2)l.each(function(){if(i===2&&e(this).hasClass("chbs-form-field-location-autocomplete")&&!t&&e(this).children('input[name="chbs_dropoff_location_service_type_2"]').length===1)return!0;var n;try{e(this).hasClass("chbs-form-field-location-autocomplete")?n=JSON.parse(e(this).children('input[type="hidden"]').val()):e(this).find("input.chbs-form-field-location-fixed-autocomplete").length===0||e(this).find("input.chbs-form-field-location-fixed-autocomplete").val().length?n=JSON.parse(e(this).find("select>option:selected").attr("data-location")):n={lat:"",lng:""}}catch{n={lat:"",lng:""}}!o.isEmpty(n.lat)&&!o.isEmpty(n.lng)&&r.push(new google.maps.LatLng(n.lat,n.lng))});else if(c=s.e('select[name="chbs_route_service_type_3"]>option:selected'),c.length===1){n=JSON.parse(c.attr("data-coordinate"));for(a in n)!o.isEmpty(n[a].lat)&&!o.isEmpty(n[a].lng)&&r.push(new google.maps.LatLng(n[a].lat,n[a].lng))}return r},this.googleMapExist=function(){return typeof a!="undefined"},this.googleMapDraggableLocationAllowed=function(){var e=s.getServiceTypeId(),t=parseInt(s.e("#panel-"+e).children(".chbs-form-field-location-fixed").length,10);return t===0&&parseInt(o.google_map_option.draggable_location.enable,10)===1&&parseInt(s.getServiceTypeId(),10)===1&&s.e('[name="chbs_waypoint_location_service_type_'+s.getServiceTypeId()+'[]"]').length},this.googleMapCreateRoute=function(t){var n,i,c,d,u,l=s.getServiceTypeId();if(!s.googleMapExist()){typeof t!="undefined"&&t();return}if(u=s.e("#panel-"+l).children(".chbs-form-field-location-autocomplete"),n=s.getCoordinate(),i=n.length,i===0){s.googleMapReInit(),typeof t!="undefined"&&t();return}l===2&&i===2&&(n=[n[0]],i=1),i>2?(d=new Array,n.forEach(function(e,t){t>0&&t<i-1&&d.push({location:e,stopover:!0})}),c={origin:n[0],waypoints:d,optimizeWaypoints:!1,destination:n[i-1],travelMode:google.maps.DirectionsTravelMode.DRIVING}):i===2?c={origin:n[0],destination:n[i-1],travelMode:google.maps.DirectionsTravelMode.DRIVING}:c={origin:n[i-1],destination:n[i-1],travelMode:google.maps.DirectionsTravelMode.DRIVING},c.avoidTolls=e.inArray("tolls",o.google_map_option.route_avoid)>-1,c.avoidFerries=e.inArray("ferries",o.google_map_option.route_avoid)>-1,c.avoidHighways=e.inArray("highways",o.google_map_option.route_avoid)>-1,parseInt(o.google_map_option.route_type,10)===2&&(c.provideRouteAlternatives=!0),m.route(c,function(n,i){if(s.googleMapClearMarker(),i===google.maps.DirectionsStatus.OK){if(s.googleMapDraggableLocationAllowed()){var c,m,p,g,v,b,j,w,y=new CHBSHelper,_=n.routes[s.getRouteIndex()],d=[];_.legs.forEach(function(e,t){t===0&&d.push({lat:e.start_location.lat(),lng:e.start_location.lng()}),e.via_waypoints.forEach(function(e){d.push({lat:e.lat(),lng:e.lng()})}),d.push({lat:e.end_location.lat(),lng:e.end_location.lng()})}),m=[],m.push(s.e('[name="chbs_pickup_location_service_type_'+s.getServiceTypeId()+'"]')),s.e('[name="chbs_waypoint_location_service_type_'+s.getServiceTypeId()+'[]"]').each(function(t,n){t>0&&m.push(e(n))}),m.push(s.e('[name="chbs_dropoff_location_service_type_'+s.getServiceTypeId()+'"]')),g=0,m.forEach(function(e){var n=e.siblings('input[type="hidden"]').val();y.isEmpty(n)||(n=JSON.parse(n),n.lat=d[g].lat,n.lng=d[g].lng,e.siblings('input[type="hidden"]').val(JSON.stringify(n)),g++)})}parseInt(o.google_map_option.route_type,10)===2&&(v=-1,n.routes.forEach(function(e,t){(e.legs[0].distance.value<v||v===-1)&&(v=e.legs[0].distance.value,h=t)})),r.setDirections(n),r.setRouteIndex(s.getRouteIndex()),f=n;for(b in n.routes[s.getRouteIndex()].legs)c=n.routes[s.getRouteIndex()].legs[b],s.googleMapCreateMarker(c.start_location),s.googleMapCreateMarker(c.end_location);if(parseInt(o.tax_rate_geofence_enable,10)===1){j=[];for(b in n.routes[s.getRouteIndex()].legs){c=n.routes[s.getRouteIndex()].legs[b];for(w in c.steps)p=c.steps[w],j.push([p.start_location,p.end_location,p.distance.value,p.lat_lngs])}s.e('input[name="chbs_route_data"]').val(JSON.stringify(j))}try{a.setCenter(r.getDirections().routes[s.getRouteIndex()].bounds.getCenter())}catch{}s.calculateRoute(n,t)}else i===google.maps.DirectionsStatus.ZERO_RESULTS&&l===1&&(alert(o.message.designate_route_error),u.each(function(){e(this).children('input[type="text"]').val(""),e(this).children('input[type="hidden"]').val("")}),s.googleMapReInit());typeof t!="undefined"&&t()})},this.googleMapClearMarker=function(){for(var e in l)l[e].setMap(null);l=[]},this.googleMapCreateMarker=function(e){if(s.googleMapDraggableLocationAllowed())return;for(t in l){if(typeof l[t].position=="undefined")continue;if(l[t].position.lat()==e.lat()&&l[t].position.lng()==e.lng())return}var t,n=l.length+1,o=new google.maps.Marker({position:e,map:a,label:""+n});l.push(o)},this.googleMapReInit=function(){if(!s.googleMapExist())return;r=new google.maps.DirectionsRenderer,m=new google.maps.DirectionsService,f=null,r.setDirections({routes:[]}),a.setZoom(o.google_map_option.zoom_control.level),s.calculateRoute();try{c!==null&&a.setCenter(c)}catch{}},this.calculateRoute=function(e,t){var i,a=0,n=0;if(typeof e!="undefined"&&typeof e.routes!="undefined")for(i=0;i<e.routes[s.getRouteIndex()].legs.length;i++)a+=e.routes[s.getRouteIndex()].legs[i].distance.value,n+=e.routes[s.getRouteIndex()].legs[i].duration.value;a/=1e3,n=Math.ceil(n/60),o.ride_time_rounding>0&&(n=Math.ceil(n/o.ride_time_rounding)*o.ride_time_rounding),s.e('input[name="chbs_distance_map"]').val(Math.round(a*10)/10),s.e('input[name="chbs_duration_map"]').val(n*o.ride_time_multiplier),s.reCalculateRoute(t)},this.reCalculateRoute=function(t){var a,c,l,d,n=0,u=0,i=0,r=parseInt(s.e('input[name="chbs_service_type_id"]').val(),10),i=s.e('input[name="chbs_distance_map"]').val();switch(r){case 1:c=new CHBSHelper,n=s.e('select[name="chbs_extra_time_service_type_1"]').val(),isNaN(n)&&(n=0),n*=o.extra_time_unit===2?60:1,s.e('input[name="chbs_waypoint_location_service_type_1[]"]').each(function(){var n,t={};try{t=JSON.parse(e(this).next("input").val())}catch{t.lat=null,t.lng=null}!c.isEmpty(t.lat)&&!c.isEmpty(t.lng)&&(n=e(this).parent(".chbs-form-field:first").next(".chbs-form-field-waypoint-duration").children("select"),parseInt(n.length,10)===1&&(u+=parseInt(n.val(),10)))});break;case 2:n=s.e('select[name="chbs_duration_service_type_2"]').val(),isNaN(n)&&(n=0),n*=60;break;case 3:n=s.e('select[name="chbs_extra_time_service_type_3"]').val(),isNaN(n)&&(n=0),n*=o.extra_time_unit===2?60:1;break}e.inArray(r,[1,3])>-1&&(l=s.e('select[name="chbs_transfer_type_service_type_'+r+'"]'),a=l.length===1?parseInt(l.val(),10)===1?1:2:1,n+=parseInt(s.e('input[name="chbs_duration_map"]').val(),10)*a+u*a,i*=a),s.e('input[name="chbs_distance_sum"]').val(i),s.e('input[name="chbs_duration_sum"]').val(n),d=s.splitTime(n),i=s.formatLength(i),s.e(".chbs-ride-info>div:eq(0)>span:eq(2)>span:eq(0)").html(i),s.e(".chbs-ride-info>div:eq(1)>span:eq(2)>span:eq(0)").html(d[0]),s.e(".chbs-ride-info>div:eq(1)>span:eq(2)>span:eq(2)").html(d[1]),s.calculateBaseLocationDistance(t)},this.formatLength=function(e){return o.length_unit===2&&(e/=1.609344,e=Math.round(e*10)/10),e},this.splitTime=function(e){return[Math.floor(e/60),e%60]},this.setWidthClass=function(){if(parseInt(o.widget.mode,10)===1&&i.hasClass("chbs-widget-style-1"))return;var r,n=i.parent().width(),t=null,a="chbs-width-";n>=1220?t="1220":n>=960?t="960":n>=768?t="768":n>=480?t="480":n>=300?t="300":t="300",r=s.getValueFromClass(i,a),r!==!1&&i.removeClass(a+r),i.addClass(a+t),s.prevWidth!==n&&(s.prevWidth=n,e(window).resize(),s.createStickySidebar(),parseInt(o.widget.mode,10)!==1&&(e.inArray(t,["300","480"])>-1?s.googleMapStopCustomizeHeight():s.googleMapStartCustomizeHeight())),setTimeout(s.setWidthClass,500)},this.getValueFromClass=function(t,n){try{var o,i=new RegExp(n),s=e(t).attr("class").split(" ");for(o in s)if(i.test(s[o]))return s[o].substring(n.length)}catch{}return!1},this.createSummaryPriceElement=function(){s.setAction("create_summary_price_element"),s.post(s.e('form[name="chbs-form"]').serialize(),function(t){s.e(".chbs-summary-price-element").replaceWith(t.html),e(window).scroll()})},this.createStickySidebar=function(){if(parseInt(o.summary_sidebar_sticky_enable,10)!==1)return;var t,n=s.getValueFromClass(i,"chbs-width-");if(e.inArray(n,["300","480","768"])>-1){s.removeStickySidebar();return}if(i.hasClass("chbs-hidden"))return;t=parseInt(s.e('input[name="chbs_step"]').val(),10),p=s.e(".chbs-main-content>.chbs-main-content-step-"+t+">.chbs-layout-25x75 .chbs-layout-column-left:first").theiaStickySidebar({additionalMarginTop:40,additionalMarginBottom:40})},this.removeStickySidebar=function(){if(parseInt(o.summarySidebarStickyEnable,10)!==1)return;try{p.destroy()}catch{}},this.getGlobalNotice=function(){var e=parseInt(s.e('input[name="chbs_step"]').val(),10);return s.e(".chbs-main-content-step-"+e+" .chbs-notice")},this.calculateBaseLocationDistance=function(t,n){typeof n=="undefined"&&(n=!1);var a,r,c,d,u,h,l=new CHBSHelper,i={distance:0,duration:0,return_distance:0,return_duration:0};return n===!1?(s.e('input[name="chbs_base_location_distance"]').val(0),s.e('input[name="chbs_base_location_duration"]').val(0),s.e('input[name="chbs_base_location_return_distance"]').val(0),s.e('input[name="chbs_base_location_return_duration"]').val(0),a={coordinate:{lat:o.base_location.coordinate.lat,lng:o.base_location.coordinate.lng}},h=s.e('input[name="chbs_vehicle_id"]').val(),c=s.e('.chbs-vehicle-list .chbs-vehicle[data-id="'+h+'"]'),c.length===1&&!l.isEmpty(c.attr("data-base_location_cooridnate_lat"))&&!l.isEmpty(c.attr("data-base_location_cooridnate_lng"))&&(a.coordinate.lat=c.attr("data-base_location_cooridnate_lat"),a.coordinate.lng=c.attr("data-base_location_cooridnate_lng"))):(i.id=n.id,a={coordinate:{lat:n.lat,lng:n.lng}}),l.isEmpty(a.coordinate.lat)||l.isEmpty(a.coordinate.lng)?(s.callback(t,i),i):(r=s.getCoordinate(!0),u=new google.maps.DirectionsService,parseInt(r.length,10)===0?(s.callback(t,i),i):(d={origin:r[0],optimizeWaypoints:!1,destination:new google.maps.LatLng(a.coordinate.lat,a.coordinate.lng),travelMode:google.maps.DirectionsTravelMode.DRIVING},u.route(d,function(o,c){if(c===google.maps.DirectionsStatus.OK){for(var f,p,g,l=0,h=0,m=0;m<o.routes[0].legs.length;m++)l+=o.routes[0].legs[m].distance.value,h+=o.routes[0].legs[m].duration.value;l/=1e3,l=Math.round(l*10)/10,h=Math.ceil(h/60),n===!1?(s.e('input[name="chbs_base_location_distance"]').val(l),s.e('input[name="chbs_base_location_duration"]').val(h)):(i.distance=l,i.duration=h),r.length>1?(f=1,p=s.getServiceTypeId(),e.inArray(p,[1,3])>-1&&(g=s.e('select[name="chbs_transfer_type_service_type_'+p+'"]'),f=g.length===1?parseInt(g.val(),10):1),d={optimizeWaypoints:!1,origin:e.inArray(f,[1,3])>-1?r[r.length-1]:r[0],destination:new google.maps.LatLng(a.coordinate.lat,a.coordinate.lng),travelMode:google.maps.DirectionsTravelMode.DRIVING},u.route(d,function(e,o){if(o===google.maps.DirectionsStatus.OK){for(var a=0,r=0,c=0;c<e.routes[0].legs.length;c++)a+=e.routes[0].legs[c].distance.value,r+=e.routes[0].legs[c].duration.value;a/=1e3,a=Math.round(a*10)/10,r=Math.ceil(r/60),n===!1?(s.e('input[name="chbs_base_location_return_distance"]').val(a),s.e('input[name="chbs_base_location_return_duration"]').val(r)):(i.return_distance=a,i.return_duration=r)}s.callback(t,i)})):s.callback(t,i)}else s.callback(t,i)}),i))},this.getRouteIndex=function(){return isNaN(h)?0:h},this.removeDoubleQuote=function(e){return e.replace(/"/g,"")},this.callback=function(e,t){typeof e!="undefined"&&e(t)},this.createButtonRadio=function(t){s.e(t).on("click",".chbs-button-radio a",function(t){t.preventDefault();var n=e(this).parent(".chbs-button-radio").find('input[type="hidden"]');e(this).siblings("a").removeClass("chbs-state-selected"),e(this).hasClass("chbs-state-selected")?(n.val(-1),e(this).removeClass("chbs-state-selected")):(n.val(e(this).attr("data-value")),e(this).addClass("chbs-state-selected"))})}};e.fn.chauffeurBookingForm=function(e){console.log("--------------------------------------------------------------------------------------------"),console.log("Chauffer Booking System for WordPress ver. "+e.plugin_version),console.log("https://1.envato.market/chauffeur-booking-system-for-wordpress-preview"),console.log("--------------------------------------------------------------------------------------------");var t=new s(this,e);return t}})(jQuery,document,window)